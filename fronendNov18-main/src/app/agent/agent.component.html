<!-- agent.component.html -->

<div class="container">

  <div class="card">
      <div class="card-header">
          <h2>Agents</h2>
      </div>

      <table class="table table-striped">
        <thead>
          <tr>
            <th>Agent Id</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Email</th>
            <th>Policy IDs</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let agent of agents" (click)="selectAgent(agent)">
            <td>{{ agent.id }}</td>
            <td>{{ agent.firstName }}</td>
            <td>{{ agent.lastName }}</td>
            <td>{{ agent.email }}</td>
            <td>{{ agent.policyIds.join(', ') }}</td>
            <td>
              <button type="button" class="btn-custom-blue" (click)="selectAgent(agent)">Edit</button>
              <button type="button" class="btn-custom-blue" (click)="deleteAgent()">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="selectedAgent">
        <h3>Edit Agent</h3>
        <form>
          <label>Agent ID:</label>
          <input [(ngModel)]="selectedAgent.id" name="id" /><br><br>

          <label>First Name:</label>
          <input [(ngModel)]="selectedAgent.firstName" name="firstName" /><br><br>

          <label>Last Name:</label>
          <input [(ngModel)]="selectedAgent.lastName" name="lastName" /><br><br>

          <label>Email:</label>
          <input [(ngModel)]="selectedAgent.email" name="email" /><br><br>

          <label>Policy IDs (comma-separated):</label>
          <input [(ngModel)]="policyIdsString" name="policyIds" /><br><br>

          <button type="button" class="btn btn-custom-blue" (click)="updateAgent()">Update</button>
          <button type="button" class="btn btn-custom-blue" (click)="deleteAgent()">Delete</button>
          <button type="button" class="btn btn-custom-blue" (click)="cancelUpdate()">Cancel</button>
        </form>
      </div>

      <div *ngIf="!selectedAgent">
        <div class="card-header">
          <button type="button" class="btn btn-success" (click)="showCreateForm()">Create</button>
        </div>
        <div *ngIf="showCreate">
          <form>
            <label>Agent ID:</label>
            <input [(ngModel)]="newAgent.id" name="id" /><br><br>

            <label>First Name:</label>
            <input [(ngModel)]="newAgent.firstName" name="firstName" /><br><br>

            <label>Last Name:</label>
            <input [(ngModel)]="newAgent.lastName" name="lastName" /><br><br>

            <label>Email:</label>
            <input [(ngModel)]="newAgent.email" name="email" /><br><br>

            <label>Policy IDs (comma-separated):</label>
            <input [(ngModel)]="policyIdsString" name="policyIds" /><br><br>

            <button type="button" class="btn btn-custom-blue" (click)="createAgent()">Create</button>
            <button type="button" class="btn btn-custom-blue" (click)="cancelCreate()">Cancel</button>
          </form>
        </div>
      </div>
  </div>
</div>
